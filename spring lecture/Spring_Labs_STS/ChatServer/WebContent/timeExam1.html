<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>SSE</title>
<script>
	var eventSource;

	function fnOnLoad() {

		document.getElementById("startBtn").addEventListener("click", function() {
			eventSource = new EventSource("http://localhost:8090/ChatServer/timeExam1.jsp");
			
			eventSource.onopen = function(event) { //서버와의 Connection이 Open되면 호출된다.
				document.getElementById("state").innerHTML = "STARTED";
			};
			
			eventSource.onmessage = function(event) { //서버에서 Message가 도착하면 호출된다.
				document.getElementById("time").innerHTML = event.data;
			};

			eventSource.onerror = function(event) { //서버와의 접속이 끊기거나 오류가 발생하면 호출된다.
				document.getElementById("state").innerHTML = "ERROR";
			};
		});

		document.getElementById("stopBtn").addEventListener("click", function() {
			if (eventSource) {
				eventSource.close(); //이벤트 스트림 연결 종료
			}

			document.getElementById("state").innerHTML = "STOP";
		});

	}
</script>
</head>
<body id="body" onload="fnOnLoad()">
	<p>
		<span id="state">STATE</span> <span id="time"></span>
	</p>
	<p>
		<input type="button" id="startBtn" value="시작" /> <input type="button" id="stopBtn" value="종료" />
	</p>
</body>
</html>